操作系统

## 1.Bootloader（引导加载程序）

bootloader是硬件加载的第一段程序，它负责引导加载kernel。bootloader引导程序一般在CPU芯片中内置，也可以固化在开发版上。

## 2.根文件系统

没有根文件系统的Linux是无法运行的，file system是Linux运行的基础，需要程序读取一些配置文件建立根文件系统，这些文件通常放在/etc目录下，例如/etc/init.cfg、/etc/init/*.cfg。bootloader引导到的第一个程序一般就是init程序，在init阶段先创建操作系统的根文件系统，再读取配置文件设置磁盘分区，创建相应目录，建立好文件系统。

以上就是Boot阶段与硬件相关的内容。只要实现了应用加载和根文件系统，一个操作系统就运行起来了，接下来就开始走到不同系统自身定制服务阶段了。

## 3. 系统服务

所谓系统提供服务，一般是由应用形式提供的，如果系统需要提供不同的服务，相应的就需要实现不同的应用。一个简单的传感数据收集系统，只需连接几个串口，循环读取串口数据，并保存数据就可以了。将写好的这段程序烧写到flash中，启动应用时读取这段程序并运行，一个纯收集数据的简单操作系统就完成了。

如果你要实现一个复杂的操作系统，如安卓、鸿蒙这样的带有图形化界面的屏幕交互，自定义应用开发，仅靠普通的脚本是不够的，这时候就要考虑分层架构。将相应的功能分为不同的层级（像OSI网络七层协议一样）解耦的实现，不然你开发一个应用的化还先要读取屏幕的电信号，解码成触点信息，再根据触点信息判断要执行什么功能，再把结果响应成怎样的图形绘制。

![img](https://gitee.com/openharmony/docs/raw/master/zh-cn/figures/1.png)

OpenHarmony架构系统中将与硬件交互的程序封装成HDF（Harmony Driver Foundation，驱动框架），对于不同的硬件替换不同的驱动程序，从而返回给上层一样的信号。例如，用户点击键盘，那个键是音量上键、哪个键是锁屏键，上层不用关注，只需要知道驱动程序传过来的是这个音量+/-、锁屏的信号就行了。